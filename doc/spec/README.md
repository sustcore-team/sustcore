# 规范

这里存放着sustcore未来开发过程中各个子系统的设计规范文档。

我们使用的C语言是一门面对过程而非面对对象的编程语言. 然而, 我们仍然使用UML来辅助描述系统的设计. 这并不意味着我们需要在系统编程中刻意去遵循面向对象的设计原则. 实际上, 我们可以从面对对象的设计方法中借鉴一些有用的概念, 并抛弃掉一些不那么适合的部分.

对于我们系统的设计而言, 一个基础的概念被称作Trait. 这个设计思路是从rust中借鉴的, 关键在于将数据与操作相分离. 它类似于传统编程语言中的Interface. 但由于我们使用的是C语言, 所以我们尽可能避免 "继承" 这一概念, 而是转向 "组合" 的设计思路. 而 Trait 则是这种设计思路的核心. 我们通过 Trait 来约束和要求不同组件的行为, 并通过 Trait 将其组合在一起. 因此 UML 中描述的一般是各种 Trait 及 Trait 的行为.

实现Trait的方式有两种: 1. 通过一个函数指针结构 2. 通过宏 3. 函数转发
当Trait的具体实现是在编译器期就能确定的, 我们倾向于使用宏来实现Trait.
当Trait的具体实现只能在运行期才能确定时, 我们则使用函数指针结构来实现Trait.
当Trait的具体实现根据不同的编译器时期而变化时, 我们则使用函数转发的方式来实现Trait.